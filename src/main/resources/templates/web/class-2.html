<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>黑龙江建筑职业技术学院-</title>
</head>
<body>
<div class="main-box">
    <div class="top">
        <div class="date">
            <div>
                <span id="old" style="margin-right: 7%;"></span>
                <span id="now" style="margin-right: 1%"></span>
            </div>
        </div>
        <div class="nav">
            <div class="fl-logo">
                <img src="/static/web/img/logo.png" width="100%">
            </div>
            <div class="fr-nav">
                <ul>
                    <li class="nav-li">
                        <a href="/">
                            首页
                        </a>
                    </li>
                    <li class="nav-li">
                        <a href="/web/detail?articleId=15">
                            中心介绍
                        </a>
                    </li>
                    <li class="nav-li">
                        <a href="/web/class?classId=33">
                            信息资源
                        </a>
                    </li>
                    <th:block th:if="${parentId} == 39">
                        <li style="width: 14%;background: url('/static/web/img/cloud.png') top center no-repeat;">
                            <a style="color: #002a89;" href="/web/class-2?parentId=39">
                                好书推荐
                            </a>
                        </li>
                        <li class="nav-li" style="">
                            <a href="/web/class-2?parentId=34">
                                读者服务
                            </a>
                        </li>
                    </th:block>
                    <th:block th:if="${parentId} == 34">
                        <li class="nav-li" style="">
                            <a href="/web/class-2?parentId=39">
                                好书推荐
                            </a>
                        </li>
                        <li style="width: 14%;background: url('/static/web/img/cloud.png') top center no-repeat;">
                            <a style="color: #002a89;" href="/web/class-2?parentId=34">
                                读者服务
                            </a>
                        </li>
                    </th:block>
                    <li class="nav-li" style="">
                        <a href="/web/message">
                            在线沟通
                        </a>
                    </li>

                </ul>
            </div>
        </div>

    </div>

    <!--主体-->
    <div class="main">
        <!--上部-->
        <div class="class2-div">
            <div class="title">
                <th:block th:if="${title.length()} > 4">
                    <p th:text="${title}" style="font-size: 12px">
                        中心介绍
                    </p>
                </th:block>
                <th:block th:if="${title.length()} <= 4">
                    <p th:text="${title}">
                        中心介绍
                    </p>
                </th:block>
            </div>
        </div>
        <!--下部-->
        <div class="class2-list-div">
            <div class="class2-list">
                <!--列表-->
                <div class="left">
                    <ul>
                        <li th:each="cl,clStat:${classList}">

                            <!--当前分类选中-->
                            <th:block th:if="${classId} == ${cl.getClassId()}">
                                <div class="left-list-div-active">
                                    <a th:text="${cl.getClassName()}"
                                       th:href="@{/web/class-2(parentId=${cl.getParentId()},classId=${cl.getClassId()})}">

                                    </a>
                                </div>
                            </th:block>
                            <!--其他-->
                            <th:block th:if="${classId} != ${cl.getClassId()}">
                                <div class="left-list-div">
                                    <a th:text="${cl.getClassName()}"
                                       th:href="@{/web/class-2(parentId=${cl.getParentId()},classId=${cl.getClassId()})}">

                                    </a>
                                </div>
                            </th:block>


                        </li>
                    </ul>
                </div>
                <div class="right">
                    <th:block th:if="${articleCount} == 1">
                        <div class="detail-content2" th:utext="${content.getArticleContent()}">

                        </div>
                    </th:block>
                    <th:block th:if="${articleCount} > 1">
                        <ul id="list">

                        </ul>
                    </th:block>

                </div>

                <div style="float: left" class="tcdPageCode2"></div>
            </div>

        </div>

    </div>

</div>

<!--底部-->
<div class="bottom">
    <p>
        黑龙江建筑职业技术学院图文信息中心版权所有 Copyright © 2015 All rights reserved<br/>
        学院地址：哈尔滨市 ● 哈尔滨新区学院路999号 邮编：150025
    </p>
</div>
</body>
<script th:inline="javascript">
    var classId = [[${classId}]];
    var parentId = [[${parentId}]];
</script>
<script type="text/javascript" src="/static/web/js/jquery.min.js"></script>
<script src="/static/web/js/detail.js"></script>
<script type="text/javascript" src="/static/web/js/jquery.page.js"></script>
<script type="text/javascript">
    $(function () {
        $.ajax({
            url: "/web/getClassPage",
            data: {
                pageNow: 1,
                pageSize: 4,
                classId: classId
            },
            success: function (res) {
                // 初始化
                var listHtml = "";
                var articleList = res.articleList;
                for (var i = 0; i < articleList.length; i++) {
                    if(i == 0){
                        listHtml += "<li style='margin-top: 0px;'>\n" +
                            "<a href='/web/detail2?articleId=" + articleList[i].articleId + "&classId="+ classId +"&parentId="+ parentId +"' target='_blank' >" +
                            articleList[i].title +
                            "</a>" +
                            "<p>" + removeHtmlTab(articleList[i].articleContent).substring(0, 200) + "</p>" +
                            "</li>";
                    }else{
                        listHtml += "<li>\n" +
                            "<a href='/web/detail2?articleId=" + articleList[i].articleId + "&classId="+ classId +"&parentId="+ parentId +"' target='_blank' >" +
                            articleList[i].title +
                            "</a>" +
                            "<p>" + removeHtmlTab(articleList[i].articleContent).substring(0, 200) + "</p>" +
                            "</li>";
                    }

                }
                $("#list").html(listHtml);

                $(".tcdPageCode2").createPage({
                    pageCount: res.pageCount,
                    current: 1,
                    backFn: function (p) {
                        $.ajax({
                            url: "/web/getClassPage",
                            data: {
                                pageNow: p,
                                pageSize: 4,
                                classId: classId
                            },
                            success: function (res) {
                                // 点击分页获取数据
                                var listHtml = "";
                                var articleList = res.articleList;
                                for (var i = 0; i < articleList.length; i++) {
                                    listHtml += "<li>\n" +
                                        "<a href='/web/detail2?articleId=" + articleList[i].articleId + "&classId="+ classId +"&parentId="+ parentId +"' target='_blank' >" +
                                        articleList[i].title +
                                        "</a>" +
                                        "<p>" + removeHtmlTab(articleList[i].articleContent).substring(0, 200) + "</p>" +
                                        "</li>";
                                    //
                                }
                                $("#list").html(listHtml);
                            }
                        });
                    }
                });

            }
        });
    });

    //去掉html标签
    function removeHtmlTab(tab) {
        return tab.replace(/<[^<>]+?>/g, '');//删除所有HTML标签
    }

</script>
</html>